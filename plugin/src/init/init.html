<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/css/style.css" rel="stylesheet">
    <title>Privacy Policy Agreement</title>
    <script>
        // Function to handle the checkbox change event
        function handlePrivacyPolicyChange(event) {
            const isChecked = event.target.checked;

            // Set the value in browser.storage.local
            browser.storage.local.set({ privacyPolicyAccepted: isChecked })
                .then(() => {
                    console.log(`Privacy policy accepted: ${isChecked}`);
                })
                .catch(error => {
                    console.error('Error setting privacy policy in storage:', error);
                });
        }

        // Add event listener after DOM is fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            const privacyCheckbox = document.getElementById('privacyPolicy');
            
            // Restore previous state from storage
            browser.storage.local.get('privacyPolicyAccepted').then(result => {
                if (result.privacyPolicyAccepted) {
                    privacyCheckbox.checked = true;
                }
            }).catch(error => {
                console.error('Error retrieving privacy policy state:', error);
            });

            // Attach the event listener to the checkbox
            privacyCheckbox.addEventListener('change', handlePrivacyPolicyChange);
        });
    </script>
</head>
<body>
    <div id="container">
    <h3>TACC media complaints collector</h3>
    <p>Please read our human friendly privacy policy before using this tool, you must agree to the policy before the tool will be enabled:</p>
    <h5>Your personal data</h5>
        <p>Your personal can consist of your first, last name and email address./p>
        <p>You can opt out of giving us this information on the sending data to TACC confirmation page. See the <a target="_blank" href="/help/html.html">help page.</a></p>
    <label>
        <input type="checkbox" id="privacyPolicy"> I agree to the Privacy Policy
    </label>
    </div>
</body>
</html>
